package tg_bot_service

import (
	"context"
	"math/rand/v2"
	"strings"

	"github.com/93mmm/burger-tg-bot.git/internal/domain/definitions"
	"github.com/93mmm/burger-tg-bot.git/internal/utils/logger"
	"github.com/pkg/errors"
)

var (
	equalsMessages = map[string]definitions.Message{
		"Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸Ð·Ð°Ð±ÐµÑ€Ð¸Ð¼ÐµÐ½ÑÐ¾Ñ‚ÑÑŽÐ´Ð°": {
			Text: "Ð¥Ð»Ð¾Ð¿Ñ‡Ð¸Ðº, Ð¾ÑÑ‚ÑƒÐ´Ð¸ ÑÐ²Ð¾ÑŽ Ð¶ÐµÐ¿Ñƒ, Ñ‚Ð²Ð¾Ð¸ Ð¼Ð¾Ð»ÑŒÐ±Ñ‹ Ð±Ñ‹Ð»Ð¸ ÑƒÑÐ»Ñ‹ÑˆÐ°Ð½Ñ‹", // Ð¸Ð»Ð¸ "Ð£ÑÐ»Ñ‹ÑˆÐ°Ð» Ñ‚ÐµÐ±Ñ, Ñ€Ð¾Ð´Ð½Ð¾Ð¹"
		},
		"Ð²Ð¸Ð´Ð¸ÑˆÑŒ": {
			Text: "Ð ÐºÐ°Ðº Ð½Ð° ÑÑ‡ÐµÑ‚ FUCK PARENTS?",
		},
		"Ñ‡Ð¸Ð·Ð±ÑƒÑ€Ð³ÐµÑ€ÑÐ±ÐµÐºÐ¾Ð½Ð¾Ð¼": {
			Text: "Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ñ‚Ðµ Ð½Ð° ÑÑ‚Ð¾Ñ‚ Ñ‡Ð¸Ð·Ð±ÑƒÑ€Ð³ÐµÑ€ Ñ Ð±ÐµÐºÐ¾Ð½Ð¾Ð¼ Ð¸Ð· Ð¿Ð°Ð±Ð° Ð¾Ñƒ Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ñ‚Ð°Ð¼ Ñ‡Ñ‚Ð¾ ÐµÑ‰Ñ‘ Ð¸ ÐºÐ°Ñ€Ñ‚Ð¾ÑˆÐºÐ° Ñ„Ñ€Ð¸ Ð¾Ð¾Ñ… Ð¾ Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ð¸Ð¸ÑÑƒÑÐµ Ð·Ð°Ð±ÐµÑ€Ð¸ Ð¼ÐµÐ½Ñ Ð¿Ñ€ÑÐ¼Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ð·Ð°Ð±ÐµÑ€Ð¸ Ð¼ÐµÐ½Ñ Ð¿Ñ€ÑÐ¼Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ Ð¾Ñ…Ñ… Ñ‘Ð¼Ð°Ñ‘ Ð¾Ñ… Ð¼Ñ‹ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð¸Ð¼ ÑÑ‚Ð¾ Ð½Ð° Ð¿ÐµÑ€Ð²Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð¿Ð¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ ÑÑ‚Ð° Ð´ÐµÐ²Ñ‡Ð¾Ð½ÐºÐ° Ð²Ñ‹Ð³Ð»ÑÐ´Ð¸Ñ‚ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ ÑÐ½Ð¾Ð³ÑˆÐ¸Ð±Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¾Ñƒ Ð¾Ð¾Ñƒ Ð¾ÑƒÑƒ Ð°-ÑÐµ-Ð°-Ð³Ð¾ Ñ€Ð°Ð½Ñ Ð¾ÑƒÑƒ Ñ‡Ñ‘Ñ€Ñ‚ Ð¼Ð¼ Ð¼Ð³Ð¼ Ð¼Ñ‹ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð¸Ð¼ ÑÑ‚Ð¾ Ð½Ð° Ñ‚Ñ€ÐµÑ‚ÑŒÐµ Ð¼ÐµÑÑ‚Ð¾ Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ ÐºÐ°Ðº Ð¶Ðµ Ð°Ð¿Ð¿ÐµÑ‚Ð¸Ñ‚Ð½Ð¾ Ð²Ñ‹Ð³Ð»ÑÐ´Ð¸Ñ‚ ÑÑ‚Ð¾Ñ‚ Ð±ÐµÐºÐ¾Ð½ Ð¾ Ð¼Ð¾Ð¹ Ð³Ñ€Ñ‘Ð±Ð°Ð½Ñ‹Ð¹ Ð¸Ð¸ÑÑƒÑ Ð¾Ñ… Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ð°Ñ…Ñ€ÐµÐ½ÐµÐ½Ð½Ð°Ñ Ð·Ð°Ð¿ÐµÑ‡Ñ‘Ð½Ð½Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð¾ÑˆÐºÐ° Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ð´Ð°Ð¹Ñ‚Ðµ Ð¼Ð½Ðµ Ð²ÑÑ‘ Ñ‚Ñ€Ð¸ Ð±Ð»Ð¸Ð½ Ð½Ñƒ-ÐºÐ° Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼ Ð¼Ñ‹ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð¸Ð¼ ÑÑ‚Ð¾ Ð½Ð° Ñ‡ÐµÑ‚Ð²Ñ‘Ñ€Ñ‚Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ ÑƒÑ…Ñ… ðŸ¤¤\n\n\nÐ¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ñ‚Ðµ Ð½Ð° ÑÑ‚Ð¾Ñ‚ Ñ‡Ð¸Ð·Ð±ÑƒÑ€Ð³ÐµÑ€ Ñ Ð±ÐµÐºÐ¾Ð½Ð¾Ð¼ Ð¸Ð· Ð¿Ð°Ð±Ð° \nÐ¾Ñƒ Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ñ‚Ð°Ð¼ Ñ‡Ñ‚Ð¾ ÐµÑ‰Ñ‘ Ð¸ ÐºÐ°Ñ€Ñ‚Ð¾ÑˆÐºÐ° Ñ„Ñ€Ð¸ \nÐ¾Ð¾Ñ… Ð¾ Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ð¸Ð¸ÑÑƒÑÐµ Ð·Ð°Ð±ÐµÑ€Ð¸ Ð¼ÐµÐ½Ñ Ð¿Ñ€ÑÐ¼Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ð·Ð°Ð±ÐµÑ€Ð¸ Ð¼ÐµÐ½Ñ Ð¿Ñ€ÑÐ¼Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ \nÐ¾Ñ…Ñ… Ñ‘Ð¼Ð°Ñ‘ Ð¾Ñ… Ð¼Ñ‹ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð¸Ð¼ ÑÑ‚Ð¾ Ð½Ð° Ð¿ÐµÑ€Ð²Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð¿Ð¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ ÑÑ‚Ð° Ð´ÐµÐ²Ñ‡Ð¾Ð½ÐºÐ° Ð²Ñ‹Ð³Ð»ÑÐ´Ð¸Ñ‚ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ ÑÐ½Ð¾Ð³ÑˆÐ¸Ð±Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ \nÐ¾Ñƒ Ð¾Ð¾Ñƒ Ð¾ÑƒÑƒ Ð°-ÑÐµ-Ð°-Ð³Ð¾ Ñ€Ð°Ð½Ñ Ð¾ÑƒÑƒ Ñ‡Ñ‘Ñ€Ñ‚ Ð¼Ð¼ Ð¼Ð³Ð¼ \nÐ¼Ñ‹ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð¸Ð¼ ÑÑ‚Ð¾ Ð½Ð° Ñ‚Ñ€ÐµÑ‚ÑŒÐµ Ð¼ÐµÑÑ‚Ð¾ \nÐ³Ð¾ÑÐ¿Ð¾Ð´Ð¸ ÐºÐ°Ðº Ð¶Ðµ Ð°Ð¿Ð¿ÐµÑ‚Ð¸Ñ‚Ð½Ð¾ Ð²Ñ‹Ð³Ð»ÑÐ´Ð¸Ñ‚ ÑÑ‚Ð¾Ñ‚ Ð±ÐµÐºÐ¾Ð½ \nÐ¾ Ð¼Ð¾Ð¹ Ð³Ñ€Ñ‘Ð±Ð°Ð½Ñ‹Ð¹ Ð¸Ð¸ÑÑƒÑ \nÐ¾Ñ… Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ð°Ñ…Ñ€ÐµÐ½ÐµÐ½Ð½Ð°Ñ Ð·Ð°Ð¿ÐµÑ‡Ñ‘Ð½Ð½Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð¾ÑˆÐºÐ° \nÐ³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ð´Ð°Ð¹Ñ‚Ðµ Ð¼Ð½Ðµ Ð²ÑÑ‘ Ñ‚Ñ€Ð¸\nÐ±Ð»Ð¸Ð½ Ð½Ñƒ-ÐºÐ° Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼ Ð¼Ñ‹ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð¸Ð¼ ÑÑ‚Ð¾ Ð½Ð° Ñ‡ÐµÑ‚Ð²Ñ‘Ñ€Ñ‚Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ \nÑƒÑ…Ñ… ðŸ¤¤",
		},
		"Ð±ÑÑ€Ð³ÐµÑ€": {
			Text: "Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ñ‚Ðµ Ð½Ð° ÑÑ‚Ð¾Ñ‚ Ñ‡Ð¸Ð·Ð±ÑƒÑ€Ð³ÐµÑ€ Ñ Ð±ÐµÐºÐ¾Ð½Ð¾Ð¼ Ð¸Ð· Ð¿Ð°Ð±Ð° Ð¾Ñƒ Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ñ‚Ð°Ð¼ Ñ‡Ñ‚Ð¾ ÐµÑ‰Ñ‘ Ð¸ ÐºÐ°Ñ€Ñ‚Ð¾ÑˆÐºÐ° Ñ„Ñ€Ð¸ Ð¾Ð¾Ñ… Ð¾ Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ð¸Ð¸ÑÑƒÑÐµ Ð·Ð°Ð±ÐµÑ€Ð¸ Ð¼ÐµÐ½Ñ Ð¿Ñ€ÑÐ¼Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ð·Ð°Ð±ÐµÑ€Ð¸ Ð¼ÐµÐ½Ñ Ð¿Ñ€ÑÐ¼Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ Ð¾Ñ…Ñ… Ñ‘Ð¼Ð°Ñ‘ Ð¾Ñ… Ð¼Ñ‹ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð¸Ð¼ ÑÑ‚Ð¾ Ð½Ð° Ð¿ÐµÑ€Ð²Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð¿Ð¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ ÑÑ‚Ð° Ð´ÐµÐ²Ñ‡Ð¾Ð½ÐºÐ° Ð²Ñ‹Ð³Ð»ÑÐ´Ð¸Ñ‚ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ ÑÐ½Ð¾Ð³ÑˆÐ¸Ð±Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¾Ñƒ Ð¾Ð¾Ñƒ Ð¾ÑƒÑƒ Ð°-ÑÐµ-Ð°-Ð³Ð¾ Ñ€Ð°Ð½Ñ Ð¾ÑƒÑƒ Ñ‡Ñ‘Ñ€Ñ‚ Ð¼Ð¼ Ð¼Ð³Ð¼ Ð¼Ñ‹ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð¸Ð¼ ÑÑ‚Ð¾ Ð½Ð° Ñ‚Ñ€ÐµÑ‚ÑŒÐµ Ð¼ÐµÑÑ‚Ð¾ Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ ÐºÐ°Ðº Ð¶Ðµ Ð°Ð¿Ð¿ÐµÑ‚Ð¸Ñ‚Ð½Ð¾ Ð²Ñ‹Ð³Ð»ÑÐ´Ð¸Ñ‚ ÑÑ‚Ð¾Ñ‚ Ð±ÐµÐºÐ¾Ð½ Ð¾ Ð¼Ð¾Ð¹ Ð³Ñ€Ñ‘Ð±Ð°Ð½Ñ‹Ð¹ Ð¸Ð¸ÑÑƒÑ Ð¾Ñ… Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ð°Ñ…Ñ€ÐµÐ½ÐµÐ½Ð½Ð°Ñ Ð·Ð°Ð¿ÐµÑ‡Ñ‘Ð½Ð½Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð¾ÑˆÐºÐ° Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ð´Ð°Ð¹Ñ‚Ðµ Ð¼Ð½Ðµ Ð²ÑÑ‘ Ñ‚Ñ€Ð¸ Ð±Ð»Ð¸Ð½ Ð½Ñƒ-ÐºÐ° Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼ Ð¼Ñ‹ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð¸Ð¼ ÑÑ‚Ð¾ Ð½Ð° Ñ‡ÐµÑ‚Ð²Ñ‘Ñ€Ñ‚Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ ÑƒÑ…Ñ… ðŸ¤¤\n\n\nÐ¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ñ‚Ðµ Ð½Ð° ÑÑ‚Ð¾Ñ‚ Ñ‡Ð¸Ð·Ð±ÑƒÑ€Ð³ÐµÑ€ Ñ Ð±ÐµÐºÐ¾Ð½Ð¾Ð¼ Ð¸Ð· Ð¿Ð°Ð±Ð° \nÐ¾Ñƒ Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ñ‚Ð°Ð¼ Ñ‡Ñ‚Ð¾ ÐµÑ‰Ñ‘ Ð¸ ÐºÐ°Ñ€Ñ‚Ð¾ÑˆÐºÐ° Ñ„Ñ€Ð¸ \nÐ¾Ð¾Ñ… Ð¾ Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ð¸Ð¸ÑÑƒÑÐµ Ð·Ð°Ð±ÐµÑ€Ð¸ Ð¼ÐµÐ½Ñ Ð¿Ñ€ÑÐ¼Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ð·Ð°Ð±ÐµÑ€Ð¸ Ð¼ÐµÐ½Ñ Ð¿Ñ€ÑÐ¼Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ \nÐ¾Ñ…Ñ… Ñ‘Ð¼Ð°Ñ‘ Ð¾Ñ… Ð¼Ñ‹ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð¸Ð¼ ÑÑ‚Ð¾ Ð½Ð° Ð¿ÐµÑ€Ð²Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð¿Ð¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ ÑÑ‚Ð° Ð´ÐµÐ²Ñ‡Ð¾Ð½ÐºÐ° Ð²Ñ‹Ð³Ð»ÑÐ´Ð¸Ñ‚ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ ÑÐ½Ð¾Ð³ÑˆÐ¸Ð±Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ \nÐ¾Ñƒ Ð¾Ð¾Ñƒ Ð¾ÑƒÑƒ Ð°-ÑÐµ-Ð°-Ð³Ð¾ Ñ€Ð°Ð½Ñ Ð¾ÑƒÑƒ Ñ‡Ñ‘Ñ€Ñ‚ Ð¼Ð¼ Ð¼Ð³Ð¼ \nÐ¼Ñ‹ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð¸Ð¼ ÑÑ‚Ð¾ Ð½Ð° Ñ‚Ñ€ÐµÑ‚ÑŒÐµ Ð¼ÐµÑÑ‚Ð¾ \nÐ³Ð¾ÑÐ¿Ð¾Ð´Ð¸ ÐºÐ°Ðº Ð¶Ðµ Ð°Ð¿Ð¿ÐµÑ‚Ð¸Ñ‚Ð½Ð¾ Ð²Ñ‹Ð³Ð»ÑÐ´Ð¸Ñ‚ ÑÑ‚Ð¾Ñ‚ Ð±ÐµÐºÐ¾Ð½ \nÐ¾ Ð¼Ð¾Ð¹ Ð³Ñ€Ñ‘Ð±Ð°Ð½Ñ‹Ð¹ Ð¸Ð¸ÑÑƒÑ \nÐ¾Ñ… Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ð°Ñ…Ñ€ÐµÐ½ÐµÐ½Ð½Ð°Ñ Ð·Ð°Ð¿ÐµÑ‡Ñ‘Ð½Ð½Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð¾ÑˆÐºÐ° \nÐ³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ð´Ð°Ð¹Ñ‚Ðµ Ð¼Ð½Ðµ Ð²ÑÑ‘ Ñ‚Ñ€Ð¸\nÐ±Ð»Ð¸Ð½ Ð½Ñƒ-ÐºÐ° Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼ Ð¼Ñ‹ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð¸Ð¼ ÑÑ‚Ð¾ Ð½Ð° Ñ‡ÐµÑ‚Ð²Ñ‘Ñ€Ñ‚Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ \nÑƒÑ…Ñ… ðŸ¤¤",
		},
		"Ñ‡ÑƒÑ€ÐºÐ°": {
			Text: "Ð§ÑƒÑ€Ð¾Ðº Ð² Ð¿ÐµÑ‡ÐºÑƒ",
		},
		"Ð½ÐµÐ³Ñ€Ñ‹": {
			Text: "ÐÐµÐ³Ñ€Ð¾Ð² ÑÐ¶ÐµÑ‡ÑŒ",
		},
		"Ð¾Ð±ÐµÐ´": {
			Text: "ÐŸÑ€Ð¸ÑÑ‚Ð½Ð¾Ð³Ð¾ Ð°Ð¿Ð¿ÐµÑ‚Ð¸Ñ‚Ð°",
		},
		"Ð½Ð°ÐºÐ¸Ð´Ð°Ð¹Ñ‚Ðµ": {
			Text: "ÐÐ°ÐºÐ¸Ð´Ð°Ð¹Ñ‚Ðµ Ð·Ð° Ð¾Ð±Ðµ Ñ‰ÐµÐºÐ¸ Ð±ÐµÐ´Ð¾Ð»Ð°Ð³Ðµ, Ð±Ð»Ð°Ð³Ð¾ÑÐ»Ð¾Ð²Ð»ÑŽ",
		},
	}

	containsMessages = map[string]definitions.Message{
		"Ð±ÑƒÑ€Ð³ÐµÑ€": {
			Text: "Ð³Ð¾ÑÐ¿Ð¾Ð´Ð¸ Ð·Ð°Ð±ÐµÑ€Ð¸ Ð¼ÐµÐ½Ñ Ð¿Ñ€ÑÐ¼Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ",
		},
		"https://git.mos.ru/buch-cloud/moscow-team-2.0": {
			Text: "Ð½Ð°ÐºÐ¸Ð´Ð°Ð¹Ñ‚Ðµ ÐµÐ¼Ñƒ Ð°Ð¿Ð¿Ñ€ÑƒÐ²Ð¾Ð²",
		},
		"Ð´ÐµÐ¹Ð»Ð¸": {
			Text: "https://telemost.yandex.ru/j/24504696564321",
		},
		"Ð´ÑÐ¹Ð»Ð¸": {
			Text: "https://telemost.yandex.ru/j/24504696564321",
		},
	}
)

func (s *Service) GetRandomMessageToSend(ctx context.Context, text string, chatID any, messageID int) (*definitions.Message, error) {
	msg, err := s.getMessageIfEquals(ctx, text, chatID)
	if err == nil {
		return msg, nil
	}
	if !errors.Is(err, definitions.ErrDecidedToNotSend) && !errors.Is(err, definitions.ErrNotFound) {
		return nil, errors.Wrap(err, "Ð¿Ñ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð½ÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°")
	}

	msg, err = s.getMessageIfContainsNoRandom(ctx, text, chatID, messageID)
	if err == nil {
		return msg, nil
	}
	if !errors.Is(err, definitions.ErrDecidedToNotSend) && !errors.Is(err, definitions.ErrNotFound) {
		return nil, errors.Wrap(err, "Ð¿Ñ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð½ÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°")
	}

	return nil, definitions.ErrDecidedToNotSend
}

func (s *Service) getMessageIfEquals(ctx context.Context, text string, chatID any) (*definitions.Message, error) {
	key := s.textToNormalForm(text)
	message, ok := equalsMessages[key]
	if !ok {
		logger.DebugKV(ctx, "Ð½Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð¸ Ð¿Ð¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ Ð½ÐµÑ‚ Ñ‚Ð°ÐºÐ¾Ð³Ð¾ ÐºÐ»ÑŽÑ‡Ð°", "key", key)
		return nil, definitions.ErrNotFound
	}

	if toSendOrNotToSend() {
		message.ChatID = chatID
		return &message, nil
	}
	logger.DebugKV(ctx, "Ð½Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð¸ Ð¿Ð¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ toSendOrNotToSend Ñ€ÐµÑˆÐ¸Ð» Ð½Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÑ‚ÑŒ", "key", key)

	return nil, definitions.ErrDecidedToNotSend
}

func (s *Service) getMessageIfContainsNoRandom(ctx context.Context, text string, chatID any, messageID int) (*definitions.Message, error) {
	for substr, msg := range containsMessages {
		if strings.Contains(text, substr) {
			msg.ChatID = chatID
			msg.ReplyMessageID = messageID
			return &msg, nil
		}
	}
	logger.DebugKV(ctx, "Ð½Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð¸ Ð¿Ð¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ Ð½ÐµÑ‚ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ñ", "text", text)
	return nil, errors.Wrap(definitions.ErrNotFound, "Ð½Ðµ Ð½Ð°ÑˆÐ»Ð¸ Ñ‡Ñ‚Ð¾ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÑ‚ÑŒ")
}

func (s *Service) textToNormalForm(text string) string {
	text = s.replacer.Replace(text)
	return strings.ToLower(text)
}

func toSendOrNotToSend() bool {
	return rand.IntN(10) > 5
}
